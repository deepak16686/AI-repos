<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 850">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <linearGradient id="secretGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#d63031"/>
      <stop offset="100%" style="stop-color:#ff7675"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ffd93d"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="850" fill="#0a0a0f"/>

  <!-- Header -->
  <rect x="0" y="0" width="1400" height="60" fill="url(#headerGrad)"/>
  <text x="700" y="38" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="24" font-weight="bold">Secrets Management Architecture</text>
  <text x="1380" y="38" text-anchor="end" fill="#888" font-family="Arial, sans-serif" font-size="12">Credentials &amp; Sensitive Data</text>

  <!-- Secret Storage Locations -->
  <g transform="translate(50, 80)">
    <text x="0" y="0" fill="#d63031" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Secret Storage Locations</text>

    <g filter="url(#shadow)" transform="translate(0, 30)">
      <rect x="0" y="0" width="1300" height="200" rx="15" fill="#1a1a2e"/>

      <!-- GitLab CI Variables -->
      <g transform="translate(20, 20)">
        <rect x="0" y="0" width="300" height="160" rx="10" fill="rgba(225,112,85,0.2)"/>
        <rect x="0" y="0" width="300" height="35" rx="10" fill="#e17055"/>
        <text x="150" y="23" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">GitLab CI/CD Variables</text>

        <text x="15" y="55" fill="#ffd93d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Secrets Stored:</text>
        <text x="20" y="73" fill="#e0e0e0" font-family="monospace" font-size="8">NEXUS_PASSWORD</text>
        <text x="20" y="88" fill="#e0e0e0" font-family="monospace" font-size="8">SONAR_TOKEN</text>
        <text x="20" y="103" fill="#e0e0e0" font-family="monospace" font-size="8">SPLUNK_HEC_TOKEN</text>
        <text x="20" y="118" fill="#e0e0e0" font-family="monospace" font-size="8">TRIVY_PASSWORD</text>

        <text x="15" y="140" fill="#81ecec" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Features:</text>
        <text x="20" y="155" fill="#888" font-family="monospace" font-size="8">Protected, Masked, Scoped</text>
      </g>

      <!-- Docker Compose Env -->
      <g transform="translate(340, 20)">
        <rect x="0" y="0" width="300" height="160" rx="10" fill="rgba(108,92,231,0.2)"/>
        <rect x="0" y="0" width="300" height="35" rx="10" fill="#6c5ce7"/>
        <text x="150" y="23" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Docker Compose .env</text>

        <text x="15" y="55" fill="#ffd93d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Configuration:</text>
        <text x="20" y="73" fill="#e0e0e0" font-family="monospace" font-size="8">POSTGRES_PASSWORD=xxx</text>
        <text x="20" y="88" fill="#e0e0e0" font-family="monospace" font-size="8">MINIO_ROOT_PASSWORD=xxx</text>
        <text x="20" y="103" fill="#e0e0e0" font-family="monospace" font-size="8">GITLAB_ROOT_PASSWORD=xxx</text>
        <text x="20" y="118" fill="#e0e0e0" font-family="monospace" font-size="8">NEXUS_ADMIN_PASSWORD=xxx</text>

        <text x="15" y="140" fill="#81ecec" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Location:</text>
        <text x="20" y="155" fill="#888" font-family="monospace" font-size="8">platform-setup/.env (gitignored)</text>
      </g>

      <!-- Tool Valves -->
      <g transform="translate(660, 20)">
        <rect x="0" y="0" width="300" height="160" rx="10" fill="rgba(0,184,148,0.2)"/>
        <rect x="0" y="0" width="300" height="35" rx="10" fill="#00b894"/>
        <text x="150" y="23" text-anchor="middle" fill="#1a1a2e" font-family="Arial, sans-serif" font-size="11" font-weight="bold">OpenWebUI Tool Valves</text>

        <text x="15" y="55" fill="#ffd93d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Runtime Configuration:</text>
        <text x="20" y="73" fill="#e0e0e0" font-family="monospace" font-size="8">GITLAB_TOKEN: glpat-xxx</text>
        <text x="20" y="88" fill="#e0e0e0" font-family="monospace" font-size="8">NEXUS_REGISTRY: http://ai-nexus:5001</text>
        <text x="20" y="103" fill="#e0e0e0" font-family="monospace" font-size="8">NEXUS_USER / NEXUS_PASS</text>

        <text x="15" y="125" fill="#81ecec" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Storage:</text>
        <text x="20" y="140" fill="#888" font-family="monospace" font-size="8">OpenWebUI database</text>
        <text x="20" y="155" fill="#888" font-family="monospace" font-size="8">Per-tool configuration</text>
      </g>

      <!-- Backend Config -->
      <g transform="translate(980, 20)">
        <rect x="0" y="0" width="300" height="160" rx="10" fill="rgba(253,203,110,0.2)"/>
        <rect x="0" y="0" width="300" height="35" rx="10" fill="#fdcb6e"/>
        <text x="150" y="23" text-anchor="middle" fill="#1a1a2e" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Backend tools_config.yaml</text>

        <text x="15" y="55" fill="#ffd93d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Integration Credentials:</text>
        <text x="20" y="73" fill="#e0e0e0" font-family="monospace" font-size="8">gitlab.token: xxx</text>
        <text x="20" y="88" fill="#e0e0e0" font-family="monospace" font-size="8">sonarqube.token: xxx</text>
        <text x="20" y="103" fill="#e0e0e0" font-family="monospace" font-size="8">nexus.username/password</text>
        <text x="20" y="118" fill="#e0e0e0" font-family="monospace" font-size="8">trivy.server_url</text>

        <text x="15" y="140" fill="#81ecec" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Mount:</text>
        <text x="20" y="155" fill="#888" font-family="monospace" font-size="8">Volume mounted in container</text>
      </g>
    </g>
  </g>

  <!-- Secret Flow in Pipeline -->
  <g transform="translate(50, 330)">
    <text x="0" y="0" fill="#ffd93d" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Secrets Flow in CI/CD Pipeline</text>

    <g filter="url(#shadow)" transform="translate(0, 30)">
      <rect x="0" y="0" width="1300" height="180" rx="15" fill="#2d3436"/>

      <!-- Flow diagram -->
      <g transform="translate(30, 25)">
        <rect x="0" y="0" width="160" height="60" rx="8" fill="#e17055"/>
        <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">GitLab Variables</text>
        <text x="80" y="42" text-anchor="middle" fill="#e0e0e0" font-family="monospace" font-size="8">Protected &amp; Masked</text>
      </g>

      <line x1="190" y1="55" x2="250" y2="55" stroke="#ffd93d" stroke-width="2" marker-end="url(#arrowhead)"/>

      <g transform="translate(260, 25)">
        <rect x="0" y="0" width="160" height="60" rx="8" fill="#6c5ce7"/>
        <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Job Environment</text>
        <text x="80" y="42" text-anchor="middle" fill="#e0e0e0" font-family="monospace" font-size="8">${NEXUS_PASSWORD}</text>
      </g>

      <line x1="420" y1="55" x2="480" y2="55" stroke="#ffd93d" stroke-width="2" marker-end="url(#arrowhead)"/>

      <g transform="translate(490, 25)">
        <rect x="0" y="0" width="180" height="60" rx="8" fill="#00b894"/>
        <text x="90" y="25" text-anchor="middle" fill="#1a1a2e" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Docker Config</text>
        <text x="90" y="42" text-anchor="middle" fill="#006060" font-family="monospace" font-size="8">config.json auths</text>
      </g>

      <line x1="670" y1="55" x2="730" y2="55" stroke="#ffd93d" stroke-width="2" marker-end="url(#arrowhead)"/>

      <g transform="translate(740, 25)">
        <rect x="0" y="0" width="160" height="60" rx="8" fill="#1ba5ad"/>
        <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Kaniko Push</text>
        <text x="80" y="42" text-anchor="middle" fill="#e0e0e0" font-family="monospace" font-size="8">Auth to Nexus</text>
      </g>

      <line x1="900" y1="55" x2="960" y2="55" stroke="#ffd93d" stroke-width="2" marker-end="url(#arrowhead)"/>

      <g transform="translate(970, 25)">
        <rect x="0" y="0" width="160" height="60" rx="8" fill="#2d3436" stroke="#00b894" stroke-width="2"/>
        <text x="80" y="25" text-anchor="middle" fill="#00b894" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Image Pushed</text>
        <text x="80" y="42" text-anchor="middle" fill="#888" font-family="monospace" font-size="8">localhost:5001/...</text>
      </g>

      <!-- Config.json example -->
      <rect x="30" y="100" width="1110" height="65" rx="8" fill="rgba(0,0,0,0.3)"/>
      <text x="50" y="120" fill="#ffd93d" font-family="monospace" font-size="9">Kaniko Docker Config Generation (in build stage script):</text>
      <text x="50" y="140" fill="#e0e0e0" font-family="monospace" font-size="8">echo '{"auths":{"${NEXUS_REGISTRY}":{"username":"${NEXUS_USERNAME}","password":"${NEXUS_PASSWORD}"}}}' &gt; /kaniko/.docker/config.json</text>
      <text x="50" y="158" fill="#888" font-family="monospace" font-size="8">Password never appears in logs (GitLab masks the value automatically)</text>
    </g>
  </g>

  <!-- Best Practices -->
  <g transform="translate(50, 560)">
    <text x="0" y="0" fill="#00b894" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Secrets Management Best Practices Implemented</text>

    <g filter="url(#shadow)" transform="translate(0, 25)">
      <rect x="0" y="0" width="640" height="200" rx="15" fill="#1a1a2e"/>
      <text x="320" y="25" text-anchor="middle" fill="#00b894" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Security Controls</text>

      <g transform="translate(20, 45)">
        <rect x="0" y="0" width="600" height="140" rx="8" fill="rgba(0,0,0,0.3)"/>

        <text x="15" y="25" fill="#00b894" font-family="Arial, sans-serif" font-size="10">1. Masked Variables</text>
        <text x="25" y="42" fill="#888" font-family="monospace" font-size="8">Secrets hidden in job logs with [MASKED]</text>

        <text x="15" y="62" fill="#00b894" font-family="Arial, sans-serif" font-size="10">2. Protected Branches</text>
        <text x="25" y="79" fill="#888" font-family="monospace" font-size="8">Secrets only available on protected branches</text>

        <text x="15" y="99" fill="#00b894" font-family="Arial, sans-serif" font-size="10">3. No Hardcoded Secrets</text>
        <text x="25" y="116" fill="#888" font-family="monospace" font-size="8">.env files gitignored, variables in CI settings</text>

        <text x="320" y="25" fill="#00b894" font-family="Arial, sans-serif" font-size="10">4. Rotation Policy</text>
        <text x="330" y="42" fill="#888" font-family="monospace" font-size="8">Tokens rotatable without code changes</text>

        <text x="320" y="62" fill="#00b894" font-family="Arial, sans-serif" font-size="10">5. Least Privilege</text>
        <text x="330" y="79" fill="#888" font-family="monospace" font-size="8">Tokens scoped to required permissions</text>

        <text x="320" y="99" fill="#00b894" font-family="Arial, sans-serif" font-size="10">6. Network Isolation</text>
        <text x="330" y="116" fill="#888" font-family="monospace" font-size="8">Services on private Docker network</text>
      </g>
    </g>

    <!-- Secret Types -->
    <g filter="url(#shadow)" transform="translate(670, 25)">
      <rect x="0" y="0" width="580" height="200" rx="15" fill="#1a1a2e"/>
      <text x="290" y="25" text-anchor="middle" fill="#d63031" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Secret Categories</text>

      <g transform="translate(20, 45)">
        <rect x="0" y="0" width="170" height="140" rx="8" fill="rgba(225,112,85,0.2)"/>
        <text x="85" y="20" text-anchor="middle" fill="#e17055" font-family="Arial, sans-serif" font-size="10" font-weight="bold">API Tokens</text>
        <text x="15" y="40" fill="#e0e0e0" font-family="monospace" font-size="7">GitLab PAT</text>
        <text x="15" y="55" fill="#e0e0e0" font-family="monospace" font-size="7">SonarQube Token</text>
        <text x="15" y="70" fill="#e0e0e0" font-family="monospace" font-size="7">Splunk HEC Token</text>
        <text x="15" y="90" fill="#888" font-family="monospace" font-size="7">Long-lived</text>
        <text x="15" y="105" fill="#888" font-family="monospace" font-size="7">Scoped access</text>
      </g>

      <g transform="translate(200, 45)">
        <rect x="0" y="0" width="170" height="140" rx="8" fill="rgba(108,92,231,0.2)"/>
        <text x="85" y="20" text-anchor="middle" fill="#a29bfe" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Passwords</text>
        <text x="15" y="40" fill="#e0e0e0" font-family="monospace" font-size="7">Nexus Admin</text>
        <text x="15" y="55" fill="#e0e0e0" font-family="monospace" font-size="7">PostgreSQL</text>
        <text x="15" y="70" fill="#e0e0e0" font-family="monospace" font-size="7">MinIO Root</text>
        <text x="15" y="90" fill="#888" font-family="monospace" font-size="7">Database access</text>
        <text x="15" y="105" fill="#888" font-family="monospace" font-size="7">Basic auth</text>
      </g>

      <g transform="translate(380, 45)">
        <rect x="0" y="0" width="170" height="140" rx="8" fill="rgba(0,184,148,0.2)"/>
        <text x="85" y="20" text-anchor="middle" fill="#00b894" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Connection Strings</text>
        <text x="15" y="40" fill="#e0e0e0" font-family="monospace" font-size="7">Redis URL</text>
        <text x="15" y="55" fill="#e0e0e0" font-family="monospace" font-size="7">PostgreSQL DSN</text>
        <text x="15" y="70" fill="#e0e0e0" font-family="monospace" font-size="7">ChromaDB Host</text>
        <text x="15" y="90" fill="#888" font-family="monospace" font-size="7">Service discovery</text>
        <text x="15" y="105" fill="#888" font-family="monospace" font-size="7">Internal network</text>
      </g>
    </g>
  </g>

  <!-- Warning -->
  <g transform="translate(50, 785)">
    <g filter="url(#shadow)">
      <rect x="0" y="0" width="1300" height="40" rx="10" fill="rgba(214,48,49,0.2)" stroke="#d63031" stroke-width="2"/>
      <text x="650" y="26" text-anchor="middle" fill="#ff7675" font-family="Arial, sans-serif" font-size="12" font-weight="bold">IMPORTANT: Never commit .env files, tokens, or passwords to Git. Use GitLab CI variables with masking enabled.</text>
    </g>
  </g>

  <!-- Footer -->
  <text x="700" y="835" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="11">AI-Powered DevOps Platform | Secrets Management | Credential Storage &amp; Security</text>
</svg>